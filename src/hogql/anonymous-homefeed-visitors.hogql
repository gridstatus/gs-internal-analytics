SELECT
  {{DATE_FUNCTION}} AS period,
  COUNT(DISTINCT person_id) AS anonymous_users
FROM events
WHERE (person.properties.email IS NULL OR person.properties.email = '')
  AND properties.$pathname = '/insights'
  AND {{DATE_FILTER}}
GROUP BY period
ORDER BY period {{ORDER_DIRECTION}}

